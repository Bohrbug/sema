!function(o){var e={};function l(p){if(e[p])return e[p].exports;var t=e[p]={i:p,l:!1,exports:{}};return o[p].call(t.exports,t,t.exports,l),t.l=!0,t.exports}l.m=o,l.c=e,l.d=function(o,e,p){l.o(o,e)||Object.defineProperty(o,e,{enumerable:!0,get:p})},l.r=function(o){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},l.t=function(o,e){if(1&e&&(o=l(o)),8&e)return o;if(4&e&&"object"==typeof o&&o&&o.__esModule)return o;var p=Object.create(null);if(l.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:o}),2&e&&"string"!=typeof o)for(var t in o)l.d(p,t,function(e){return o[e]}.bind(null,t));return p},l.n=function(o){var e=o&&o.__esModule?function(){return o.default}:function(){return o};return l.d(e,"a",e),e},l.o=function(o,e){return Object.prototype.hasOwnProperty.call(o,e)},l.p="",l(l.s=0)}([function(o,e,l){"use strict";l.r(e);var p=0,t={},s={saw:{setup:(o,e)=>`${o} = new Module.maxiOsc();\n                      ${o}.phaseReset(${e.length>1?e[1].loop:0});`,loop:(o,e)=>`${o}.saw(${e[0].loop})`},sin:{setup:(o,e)=>`${o} = new Module.maxiOsc();\n                      ${o}.phaseReset(${e.length>1?e[1].loop:0});`,loop:(o,e)=>`${o}.sinewave(${e[0].loop})`},tri:{setup:(o,e)=>`${o} = new Module.maxiOsc();\n                      ${o}.phaseReset(${e.length>1?e[1].loop:0});`,loop:(o,e)=>`${o}.triangle(${e[0].loop})`},pha:{setup:(o,e)=>`${o} = new Module.maxiOsc();\n                      ${o}.phaseReset(${e.length>1?e[1].loop:0});`,loop:(o,e)=>`${o}.phasor(${e[0].loop})`},ph2:{setup:(o,e)=>`${o} = new Module.maxiOsc();\n                      ${o}.phaseReset(${e.length>3?e[3].loop:0});`,loop:(o,e)=>`${o}.phasor(${e[0].loop},${e[1].loop},${e[2].loop})`},sqr:{setup:(o,e)=>`${o} = new Module.maxiOsc();\n                      ${o}.phaseReset(${e.length>1?e[1].loop:0});`,loop:(o,e)=>`${o}.square(${e[0].loop})`},pul:{setup:(o,e)=>`${o} = new Module.maxiOsc();\n                      ${o}.phaseReset(${e.length>2?e[2].loop:0});`,loop:(o,e)=>`${o}.pulse(${e[0].loop},${e[1].loop})`},imp:{setup:(o,e)=>`${o} = new Module.maxiOsc();\n                      ${o}.phaseReset(${e.length>1?e[1].loop:0});`,loop:(o,e)=>`${o}.impulse(${e[0].loop})`},sawn:{setup:(o,e)=>`${o} = new Module.maxiOsc();\n                      ${o}.phaseReset(${e.length>1?e[1].loop:0});`,loop:(o,e)=>`${o}.sawn(${e[0].loop})`},noiz:{setup:(o,e)=>`${o} = new Module.maxiOsc()`,loop:(o,e)=>`${o}.noise()*${e[0].loop}`},gt:{setup:(o,e)=>"",loop:(o,e)=>`((${e[0].loop} > ${e[1].loop}) ? 1 : 0)`},lt:{setup:(o,e)=>"",loop:(o,e)=>`((${e[0].loop} < ${e[1].loop}) ? 1 : 0)`},mod:{setup:(o,e)=>"",loop:(o,e)=>`(${e[0].loop} % ${e[1].loop})`},add:{setup:(o,e)=>"",loop:(o,e)=>`(${e[0].loop}+${e[1].loop})`},mul:{setup:(o,e)=>"",loop:(o,e)=>`(${e[0].loop}*${e[1].loop})`},sub:{setup:(o,e)=>"",loop:(o,e)=>`(${e[0].loop}-${e[1].loop})`},div:{setup:(o,e)=>"",loop:(o,e)=>`(${e[1].loop} != 0 ? ${e[0].loop}/${e[1].loop} : 0)`},pow:{setup:(o,e)=>"",loop:(o,e)=>`Math.pow(${e[0].loop},${e[1].loop})`},abs:{setup:(o,e)=>"",loop:(o,e)=>`Math.abs(${e[0].loop})`},env:{setup:(o,e)=>`${o} = new Module.maxiEnv();\n                      ${o}.setAttack(${e[1].loop});\n                      ${o}.setDecay(${e[2].loop});\n                      ${o}.setSustain(${e[3].loop});\n                      ${o}.setRelease(${e[4].loop})`,loop:(o,e)=>`${o}.adsr(1,${e[0].loop})`},sum:{setup:(o,e)=>"",loop:(o,e)=>{let l=`(${e[0].loop}`;for(let o=1;o<e.length;o++)l+=`+${e[o].loop}`;return l+")"}},mix:{setup:(o,e)=>"",loop:(o,e)=>{let l=`((${e[0].loop}`;for(let o=1;o<e.length;o++)l+=`+${e[o].loop}`;return l+`)/${e.length})`}},prod:{setup:(o,e)=>"",loop:(o,e)=>{let l=`(${e[0].loop}`;for(let o=1;o<e.length;o++)l+=`*${e[o].loop}`;return l+")"}},blin:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiMap.linlin(${e[0].loop}, -1, 1, ${e[1].loop}, ${e[2].loop})`},ulin:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiMap.linlin(${e[0].loop}, 0, 1, ${e[1].loop}, ${e[2].loop})`},bexp:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiMap.linexp(${e[0].loop}, -1, 1, ${e[1].loop}, ${e[2].loop})`},uexp:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiMap.linexp(${e[0].loop}, 0.0000001, 1, ${e[1].loop}, ${e[2].loop})`},linlin:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiMap.linlin(${e[0].loop}, ${e[1].loop}, ${e[2].loop}),${e[3].loop}, ${e[4].loop})`},linexp:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiMap.linexp(${e[0].loop}, ${e[1].loop}, ${e[2].loop}), ${e[3].loop}, ${e[4].loop})`},dist:{setup:(o,e)=>`${o} = new Module.maxiDistortion()`,loop:(o,e)=>`${o}.atanDist(${e[0].loop},${e[1].loop})`},flange:{setup:(o,e)=>`${o} = new Module.maxiFlanger()`,loop:(o,e)=>`${o}.flange(${e[0].loop},${e[1].loop},${e[2].loop},${e[3].loop},${e[4].loop})`},chor:{setup:(o,e)=>`${o} = new Module.maxiChorus()`,loop:(o,e)=>`${o}.chorus(${e[0].loop},${e[1].loop},${e[2].loop},${e[3].loop},${e[4].loop})`},dl:{setup:(o,e)=>`${o} = new Module.maxiDelayline()`,loop:(o,e)=>`${o}.dl(${e[0].loop},${e[1].loop},${e[2].loop})`},lpf:{setup:(o,e)=>`${o} = new Module.maxiFilter()`,loop:(o,e)=>`${o}.lopass(${e[0].loop},${e[1].loop})`},hpf:{setup:(o,e)=>`${o} = new Module.maxiFilter()`,loop:(o,e)=>`${o}.hipass(${e[0].loop},${e[1].loop})`},lpz:{setup:(o,e)=>`${o} = new Module.maxiFilter()`,loop:(o,e)=>`${o}.lores(${e[0].loop},${e[1].loop},${e[2].loop})`},hpz:{setup:(o,e)=>`${o} = new Module.maxiFilter()`,loop:(o,e)=>`${o}.hires(${e[0].loop},${e[1].loop},${e[2].loop})`},toJS:{setup:(o,e)=>`${o} = this.createMLOutputTransducer(${e[0].loop})`,loop:(o,e)=>`${o}.send(this.ifListThenToArray(${e[1].loop}), ${e[2].loop})`},fromJS:{setup:(o,e)=>`${o} = this.registerInputTransducer('ML', ${e[0].loop})`,loop:(o,e)=>`${o}.getValue()`},toNet:{setup:(o,e)=>`${o} = this.createNetOutputTransducer(${e[3].loop})`,loop:(o,e)=>`${o}.send(${e[0].loop},[${e[1].loop},${e[2].loop}])`},fromNet:{setup:(o,e)=>`${o} = this.registerInputTransducer('NET', [${e[0].loop}, ${e[1].loop}])`,loop:(o,e)=>`${o}.getValue()`},oscin:{setup:(o,e)=>"",loop:(o,e)=>`this.OSCTransducer(${e[0].loop},${e[1].loop})`},oscout:{setup:(o,e)=>"",loop:(o,e)=>`this.OSCTransducer(${e[0].loop},${e[1].loop})`},sah:{setup:(o,e)=>`${o} = new Module.maxiSampleAndHold();`,loop:(o,e)=>`${o}.sah(${e[0].loop},${e[1].loop})`},stretch:{setup:(o,e)=>`${o} = new Module.maxiSample();\n                      ${o}.setSample(this.getSampleBuffer(${e[4].loop}));\n                      ${o}stretch = new Module.maxiStretch();\n                      ${o}stretch.setSample(${o});`,loop:(o,e)=>`(${o}.isReady() ? ${o}stretch.play(${e[0].loop},${e[1].loop},${e[2].loop},${e[3].loop},0.0) : 0.0)`},adc:{setup:(o,e)=>"",loop:(o,e)=>"inputs"},sampler:{setup:(o,e)=>`${o} = new Module.maxiSample();\n                      ${o}.setSample(this.getSampleBuffer(${e[1].loop}));`,loop:(o,e)=>`(${o}.isReady() ? ${o}.playOnZX(${e[0].loop}) : 0.0)`},loop:{setup:(o,e)=>`${o} = new Module.maxiSample();\n                      ${o}.setSample(this.getSampleBuffer(${e[1].loop}));`,loop:(o,e)=>`(${o}.isReady() ? ${o}.play(${e[0].loop}) : 0.0)`},slice:{setup:(o,e)=>`${o} = new Module.maxiSample();\n                      ${o}.setSample(this.getSampleBuffer(${e[2].loop}));`,loop:(o,e)=>`(${o}.isReady() ? ${o}.loopSetPosOnZX(${e[0].loop},${e[1].loop}) : 0.0)`},oscin:{setup:(o,e)=>"",loop:(o,e)=>`this.OSCTransducer(${e[0].loop},${e[1].loop})`},oscout:{setup:(o,e)=>"",loop:(o,e)=>`this.OSCTransducer(${e[0].loop},${e[1].loop})`},sah:{setup:(o,e)=>`${o} = new Module.maxiSampleAndHold();`,loop:(o,e)=>`${o}.sah(${e[0].loop},${e[1].loop})`},stretch:{setup:(o,e)=>`${o} = new Module.maxiSample();\n                      ${o}.setSample(this.getSampleBuffer(${e[4].loop}));\n                      ${o}stretch = new Module.maxiStretch();\n                      ${o}stretch.setSample(${o});`,loop:(o,e)=>`(${o}.isReady() ? ${o}stretch.play(${e[0].loop},${e[1].loop},${e[2].loop},${e[3].loop},0.0) : 0.0)`},bitToSig:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.toSignal(${e[0].loop})`},bitToTrigSig:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.toTrigSignal(${e[0].loop})`},bitNeg:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.neg(${e[0].loop})`},bitInc:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.inc(${e[0].loop})`},bitDec:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.dec(${e[0].loop})`},bitAnd:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.land(${e[0].loop},${e[1].loop})`},bitOr:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.lor(${e[0].loop},${e[1].loop})`},bitXor:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.lxor(${e[0].loop},${e[1].loop})`},bitShl:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.shl(${e[0].loop},${e[1].loop})`},bitShr:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.shr(${e[0].loop},${e[1].loop})`},bitAt:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.at(${e[0].loop},${e[1].loop})`},bitAdd:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.add(${e[0].loop},${e[1].loop})`},bitSub:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.sub(${e[0].loop},${e[1].loop})`},bitMul:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.mul(${e[0].loop},${e[1].loop})`},bitEq:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.eq(${e[0].loop},${e[1].loop})`},bitGt:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.gt(${e[0].loop},${e[1].loop})`},bitGte:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.gte(${e[0].loop},${e[1].loop})`},bitLte:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.lte(${e[0].loop},${e[1].loop})`},bitLt:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.lt(${e[0].loop},${e[1].loop})`},setup:(o,e)=>"",bitDiv:{loop:(o,e)=>`Module.maxiBits.div(${e[0].loop},${e[1].loop})`},bitr:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.at(${e[0].loop},${e[1].loop},${e[2].loop})`},bitnoise:{setup:(o,e)=>"",loop:(o,e)=>"Module.maxiBits.noise()"},btime:{setup:(o,e)=>"",loop:(o,e)=>"this.bitTime"},bitFromSig:{setup:(o,e)=>"",loop:(o,e)=>`Module.maxiBits.fromSignal(${e[0].loop})`},clp:{setup:(o,e)=>"",loop:(o,e)=>`this.clockPhase(${e[0].loop},${e.length>1?e[1].loop:0})`},clt:{setup:(o,e)=>"",loop:(o,e)=>`this.clockTrig(${e[0].loop},${e.length>1?e[1].loop:0})`},clfreq:{setup:(o,e)=>"",loop:(o,e)=>`this.setClockFreq(${e[0].loop})`},clbpm:{setup:(o,e)=>"",loop:(o,e)=>`this.setClockFreq(60/${e[0].loop})`},onzx:{setup:(o,e)=>`${o} = new Module.maxiTrigger();`,loop:(o,e)=>`${o}.onZX(${e[0].loop})`},onchange:{setup:(o,e)=>`${o} = new Module.maxiTrigger();`,loop:(o,e)=>`${o}.onChanged(${e[0].loop},${e[1].loop})`},count:{setup:(o,e)=>`${o} = new Module.maxiCounter();`,loop:(o,e)=>`${o}.count(${e[0].loop},${e[1].loop})`},idx:{setup:(o,e)=>`${o} = new Module.maxiIndex();`,loop:(o,e)=>`${o}.pull(${e[0].loop},${e[1].loop},${e[2].loop})`},svf:{setup:(o,e)=>`${o} = new Module.maxiSVF(); ${o}_p1 = new Module.maxiTrigger(); ${o}_p2 = new Module.maxiTrigger();`,loop:(o,e)=>`(()=>{${o}_cutoff = ${e[1].loop}; if (${o}_p1.onChanged(${o}_cutoff, 1e-5)) {${o}.setCutoff(${o}_cutoff)};\n                            ${o}_res = ${e[2].loop}; if (${o}_p2.onChanged(${o}_res, 1e-5)) {${o}.setResonance(${o}_res)};\n                        return ${o}.play(${e[0].loop},${e[3].loop},${e[4].loop},${e[5].loop},${e[6].loop})})()`},bitclock:{setup:(o,e)=>"",loop:(o,e)=>"this.bitclock"},pvshift:{setup:(o,e)=>`${o} = new pvshift();`,loop:(o,e)=>`${o}.play(${e[0].loop},${e[1].loop})`}};class ${static getNextID(){return p=p>9999?0:++p}static emptyCode(){return{setup:"",loop:"",paramMarkers:[]}}static traverseTree(o,e,l,p,t){let u={"@lang":(o,e)=>(e.map(e=>{let s=$.traverseTree(e,$.emptyCode(),l,p,t);o.setup+=s.setup,o.loop+=s.loop}),o),"@sigOut":(o,e)=>((o=$.traverseTree(e,o,l,p,t)).loop=`q.sigOut = ${o.loop};`,o),"@spawn":(o,e)=>((o=$.traverseTree(e,o,l,p,t)).loop+=";",o),"@sigp":(o,e)=>{let u=[{s:e.paramBegin,e:e.paramEnd,l:l}];o.paramMarkers=o.paramMarkers.concat(u);let a=e["@func"].value,i=s[a],r="q.b"+t+"u"+$.getNextID(),n=[];for(let o=0;o<e["@params"].length;o++){let s=$.emptyCode();s=$.traverseTree(e["@params"][o],s,l+1,p,t),n[o]=s}let m="";for(let e in n)m+=n[e].setup,o.paramMarkers=o.paramMarkers.concat(n[e].paramMarkers);return o.setup+=`${m} ${i.setup(r,n)};`,o.loop+=`${i.loop(r,n)}`,o},"@setvar":(o,e)=>{let s=e["@varname"].value,u=p[s];null==u&&(u=Object.keys(p).length,p[s]=u);let a=$.traverseTree(e["@varvalue"],$.emptyCode(),l+1,p,t);return o.setup+=a.setup,o.loop=`(mem[${u}] = ${a.loop})`,o},"@getvar":(o,e)=>{let l=p[e.value];return null==l&&(l=Object.keys(p).length,p[e.value]=l),o.loop+=`mem[${l}]`,o},"@string":(o,e)=>(console.log(e.value),("string"==typeof e.value||e.value instanceof String)&&(o.loop+=`'${e.value}'`),o),"@num":(o,e)=>(e.value&&(o.loop+=`${e.value}`),o),"@list":(o,e)=>{let s="q.b"+t+"l"+$.getNextID();o.setup+=`${s} = new Module.VectorDouble();`,o.setup+=`${s}.resize(${e.length},0);`,o.loop+="(()=>{";let u="";for(let a=0;a<e.length;a++){let i=$.traverseTree(e[a],$.emptyCode(),l,p,t);"@num"==Object.keys(e[a])[0]?o.setup+=`${s}.set(${a}, ${i.loop});`:(u+=i.setup,o.loop+=`${s}.set(${a}, ${i.loop});`)}return o.loop+=`return ${s}})()`,o.setup+=u,o}};return Array.isArray(o)?o.map(o=>{Object.keys(o).map(l=>{console.log(l),e=u[l](e,o[l])})}):Object.keys(o).map(l=>{console.log(l),e=u[l](e,o[l])}),e}static treeToCode(o,e=0){t={};let l=$.traverseTree(o,$.emptyCode(),0,t,e);return l.setup=`() => {let q=this.newq(); ${l.setup}; return q;}`,l.loop=`(q, inputs, mem) => {${l.loop} return q.sigOut;}`,l}}var u=$;onmessage=o=>{if(void 0!==o.data)try{let e=u.treeToCode(o.data.liveCodeAbstractSyntaxTree[0]);e.paramMarkers=JSON.stringify(e.paramMarkers),postMessage(e)}catch(o){console.log("DEBUG:il.worker:onmessage:catch"),console.log(o)}}}]);
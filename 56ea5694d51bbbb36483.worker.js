!function(o){var l={};function e(p){if(l[p])return l[p].exports;var t=l[p]={i:p,l:!1,exports:{}};return o[p].call(t.exports,t,t.exports,e),t.l=!0,t.exports}e.m=o,e.c=l,e.d=function(o,l,p){e.o(o,l)||Object.defineProperty(o,l,{enumerable:!0,get:p})},e.r=function(o){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},e.t=function(o,l){if(1&l&&(o=e(o)),8&l)return o;if(4&l&&"object"==typeof o&&o&&o.__esModule)return o;var p=Object.create(null);if(e.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:o}),2&l&&"string"!=typeof o)for(var t in o)e.d(p,t,function(l){return o[l]}.bind(null,t));return p},e.n=function(o){var l=o&&o.__esModule?function(){return o.default}:function(){return o};return e.d(l,"a",l),l},e.o=function(o,l){return Object.prototype.hasOwnProperty.call(o,l)},e.p="",e(e.s=0)}([function(o,l,e){"use strict";e.r(l);var p=0,t={},i={saw:{setup:(o,l)=>`${o} = new Maximilian.maxiOsc();\n                      ${o}.phaseReset(${l.length>1?l[1].loop:0});`,loop:(o,l)=>`${o}.saw(${l[0].loop})`},sin:{setup:(o,l)=>`${o} = new Maximilian.maxiOsc();\n                      ${o}.phaseReset(${l.length>1?l[1].loop:0});`,loop:(o,l)=>`${o}.sinewave(${l[0].loop})`},tri:{setup:(o,l)=>`${o} = new Maximilian.maxiOsc();\n                      ${o}.phaseReset(${l.length>1?l[1].loop:0});`,loop:(o,l)=>`${o}.triangle(${l[0].loop})`},pha:{setup:(o,l)=>`${o} = new Maximilian.maxiOsc();\n                      ${o}.phaseReset(${l.length>1?l[1].loop:0});`,loop:(o,l)=>`${o}.phasor(${l[0].loop})`},ph2:{setup:(o,l)=>`${o} = new Maximilian.maxiOsc();\n                      ${o}.phaseReset(${l.length>3?l[3].loop:0});`,loop:(o,l)=>`${o}.phasor(${l[0].loop},${l[1].loop},${l[2].loop})`},sqr:{setup:(o,l)=>`${o} = new Maximilian.maxiOsc();\n                      ${o}.phaseReset(${l.length>1?l[1].loop:0});`,loop:(o,l)=>`${o}.square(${l[0].loop})`},pul:{setup:(o,l)=>`${o} = new Maximilian.maxiOsc();\n                      ${o}.phaseReset(${l.length>2?l[2].loop:0});`,loop:(o,l)=>`${o}.pulse(${l[0].loop},${l[1].loop})`},imp:{setup:(o,l)=>`${o} = new Maximilian.maxiOsc();\n                      ${o}.phaseReset(${l.length>1?l[1].loop:0});`,loop:(o,l)=>`${o}.impulse(${l[0].loop})`},sawn:{setup:(o,l)=>`${o} = new Maximilian.maxiOsc();\n                      ${o}.phaseReset(${l.length>1?l[1].loop:0});`,loop:(o,l)=>`${o}.sawn(${l[0].loop})`},noiz:{setup:(o,l)=>`${o} = new Maximilian.maxiOsc()`,loop:(o,l)=>`${o}.noise()*${l[0].loop}`},gt:{setup:(o,l)=>"",loop:(o,l)=>`((${l[0].loop} > ${l[1].loop}) ? 1 : 0)`},lt:{setup:(o,l)=>"",loop:(o,l)=>`((${l[0].loop} < ${l[1].loop}) ? 1 : 0)`},mod:{setup:(o,l)=>"",loop:(o,l)=>`(${l[0].loop} % ${l[1].loop})`},add:{setup:(o,l)=>"",loop:(o,l)=>`(${l[0].loop}+${l[1].loop})`},mul:{setup:(o,l)=>"",loop:(o,l)=>`(${l[0].loop}*${l[1].loop})`},sub:{setup:(o,l)=>"",loop:(o,l)=>`(${l[0].loop}-${l[1].loop})`},div:{setup:(o,l)=>"",loop:(o,l)=>`(${l[1].loop} != 0 ? ${l[0].loop}/${l[1].loop} : 0)`},pow:{setup:(o,l)=>"",loop:(o,l)=>`Math.pow(${l[0].loop},${l[1].loop})`},abs:{setup:(o,l)=>"",loop:(o,l)=>`Math.abs(${l[0].loop})`},env:{setup:(o,l)=>`${o} = new Maximilian.maxiEnv();\n                      ${o}.setAttack(${l[1].loop});\n                      ${o}.setDecay(${l[2].loop});\n                      ${o}.setSustain(${l[3].loop});\n                      ${o}.setRelease(${l[4].loop})`,loop:(o,l)=>`${o}.adsr(1,${l[0].loop})`},sum:{setup:(o,l)=>"",loop:(o,l)=>{let e=`(${l[0].loop}`;for(let o=1;o<l.length;o++)e+=`+${l[o].loop}`;return e+")"}},mix:{setup:(o,l)=>"",loop:(o,l)=>{let e=`((${l[0].loop}`;for(let o=1;o<l.length;o++)e+=`+${l[o].loop}`;return e+`)/${l.length})`}},prod:{setup:(o,l)=>"",loop:(o,l)=>{let e=`(${l[0].loop}`;for(let o=1;o<l.length;o++)e+=`*${l[o].loop}`;return e+")"}},blin:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiMap.linlin(${l[0].loop}, -1, 1, ${l[1].loop}, ${l[2].loop})`},ulin:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiMap.linlin(${l[0].loop}, 0, 1, ${l[1].loop}, ${l[2].loop})`},bexp:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiMap.linexp(${l[0].loop}, -1, 1, ${l[1].loop}, ${l[2].loop})`},uexp:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiMap.linexp(${l[0].loop}, 0.0000001, 1, ${l[1].loop}, ${l[2].loop})`},linlin:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiMap.linlin(${l[0].loop}, ${l[1].loop}, ${l[2].loop}),${l[3].loop}, ${l[4].loop})`},linexp:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiMap.linexp(${l[0].loop}, ${l[1].loop}, ${l[2].loop}), ${l[3].loop}, ${l[4].loop})`},dist:{setup:(o,l)=>`${o} = new Maximilian.maxiDistortion()`,loop:(o,l)=>`${o}.atanDist(${l[0].loop},${l[1].loop})`},flange:{setup:(o,l)=>`${o} = new Maximilian.maxiFlanger()`,loop:(o,l)=>`${o}.flange(${l[0].loop},${l[1].loop},${l[2].loop},${l[3].loop},${l[4].loop})`},chor:{setup:(o,l)=>`${o} = new Maximilian.maxiChorus()`,loop:(o,l)=>`${o}.chorus(${l[0].loop},${l[1].loop},${l[2].loop},${l[3].loop},${l[4].loop})`},dl:{setup:(o,l)=>`${o} = new Maximilian.maxiDelayline()`,loop:(o,l)=>`${o}.dl(${l[0].loop},${l[1].loop},${l[2].loop})`},lpf:{setup:(o,l)=>`${o} = new Maximilian.maxiFilter()`,loop:(o,l)=>`${o}.lopass(${l[0].loop},${l[1].loop})`},hpf:{setup:(o,l)=>`${o} = new Maximilian.maxiFilter()`,loop:(o,l)=>`${o}.hipass(${l[0].loop},${l[1].loop})`},lpz:{setup:(o,l)=>`${o} = new Maximilian.maxiFilter()`,loop:(o,l)=>`${o}.lores(${l[0].loop},${l[1].loop},${l[2].loop})`},hpz:{setup:(o,l)=>`${o} = new Maximilian.maxiFilter()`,loop:(o,l)=>`${o}.hires(${l[0].loop},${l[1].loop},${l[2].loop})`},toJS:{setup:(o,l)=>`${o} = this.createMLOutputTransducer(${l[0].loop})`,loop:(o,l)=>`${o}.send(this.ifListThenToArray(${l[1].loop}), ${l[2].loop})`},fromJS:{setup:(o,l)=>`${o} = this.registerInputTransducer('ML', ${l[0].loop})`,loop:(o,l)=>`${o}.getValue()`},toPeer:{setup:(o,l)=>`${o} = this.createNetOutputTransducer(${l[3].loop})`,loop:(o,l)=>`${o}.send(${l[0].loop},[${l[1].loop},${l[2].loop}])`},fromPeer:{setup:(o,l)=>`${o} = this.registerInputTransducer('NET', [${l[0].loop}, ${l[1].loop}])`,loop:(o,l)=>`${o}.getValue()`},oscin:{setup:(o,l)=>"",loop:(o,l)=>`this.OSCTransducer(${l[0].loop},${l[1].loop})`},oscout:{setup:(o,l)=>"",loop:(o,l)=>`this.OSCTransducer(${l[0].loop},${l[1].loop})`},sah:{setup:(o,l)=>`${o} = new Maximilian.maxiSampleAndHold();`,loop:(o,l)=>`${o}.sah(${l[0].loop},${l[1].loop})`},stretch:{setup:(o,l)=>`${o} = new Maximilian.maxiSample();\n                      ${o}.setSample(this.getSampleBuffer(${l[4].loop}));\n                      ${o}stretch = new Maximilian.maxiStretch();\n                      ${o}stretch.setSample(${o});`,loop:(o,l)=>`(${o}.isReady() ? ${o}stretch.play(${l[0].loop},${l[1].loop},${l[2].loop},${l[3].loop},0.0) : 0.0)`},adc:{setup:(o,l)=>"",loop:(o,l)=>"inputs"},sampler:{setup:(o,l)=>`${o} = new Maximilian.maxiSample();\n                      ${o}.setSample(this.getSampleBuffer(${l[1].loop}));`,loop:(o,l)=>`(${o}.isReady() ? ${o}.playOnZX(${l[0].loop}) : 0.0)`},loop:{setup:(o,l)=>`${o} = new Maximilian.maxiSample();\n                      ${o}.setSample(this.getSampleBuffer(${l[1].loop}));`,loop:(o,l)=>`(${o}.isReady() ? ${o}.play(${l[0].loop}) : 0.0)`},slice:{setup:(o,l)=>`${o} = new Maximilian.maxiSample();\n                      ${o}.setSample(this.getSampleBuffer(${l[2].loop}));`,loop:(o,l)=>`(${o}.isReady() ? ${o}.loopSetPosOnZX(${l[0].loop},${l[1].loop}) : 0.0)`},oscin:{setup:(o,l)=>"",loop:(o,l)=>`this.OSCTransducer(${l[0].loop},${l[1].loop})`},oscout:{setup:(o,l)=>"",loop:(o,l)=>`this.OSCTransducer(${l[0].loop},${l[1].loop})`},sah:{setup:(o,l)=>`${o} = new Maximilian.maxiSampleAndHold();`,loop:(o,l)=>`${o}.sah(${l[0].loop},${l[1].loop})`},stretch:{setup:(o,l)=>`${o} = new Maximilian.maxiSample();\n                      ${o}.setSample(this.getSampleBuffer(${l[4].loop}));\n                      ${o}stretch = new Maximilian.maxiStretch();\n                      ${o}stretch.setSample(${o});`,loop:(o,l)=>`(${o}.isReady() ? ${o}stretch.play(${l[0].loop},${l[1].loop},${l[2].loop},${l[3].loop},0.0) : 0.0)`},bitToSig:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.toSignal(${l[0].loop})`},bitToTrigSig:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.toTrigSignal(${l[0].loop})`},bitNeg:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.neg(${l[0].loop})`},bitInc:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.inc(${l[0].loop})`},bitDec:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.dec(${l[0].loop})`},bitAnd:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.land(${l[0].loop},${l[1].loop})`},bitOr:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.lor(${l[0].loop},${l[1].loop})`},bitXor:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.lxor(${l[0].loop},${l[1].loop})`},bitShl:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.shl(${l[0].loop},${l[1].loop})`},bitShr:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.shr(${l[0].loop},${l[1].loop})`},bitAt:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.at(${l[0].loop},${l[1].loop})`},bitAdd:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.add(${l[0].loop},${l[1].loop})`},bitSub:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.sub(${l[0].loop},${l[1].loop})`},bitMul:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.mul(${l[0].loop},${l[1].loop})`},bitEq:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.eq(${l[0].loop},${l[1].loop})`},bitGt:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.gt(${l[0].loop},${l[1].loop})`},bitGte:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.gte(${l[0].loop},${l[1].loop})`},bitLte:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.lte(${l[0].loop},${l[1].loop})`},bitLt:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.lt(${l[0].loop},${l[1].loop})`},setup:(o,l)=>"",bitDiv:{loop:(o,l)=>`Maximilian.maxiBits.div(${l[0].loop},${l[1].loop})`},bitr:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.at(${l[0].loop},${l[1].loop},${l[2].loop})`},bitnoise:{setup:(o,l)=>"",loop:(o,l)=>"Maximilian.maxiBits.noise()"},btime:{setup:(o,l)=>"",loop:(o,l)=>"this.bitTime"},bitFromSig:{setup:(o,l)=>"",loop:(o,l)=>`Maximilian.maxiBits.fromSignal(${l[0].loop})`},clp:{setup:(o,l)=>"",loop:(o,l)=>`this.clockPhase(${l[0].loop},${l.length>1?l[1].loop:0})`},clt:{setup:(o,l)=>"",loop:(o,l)=>`this.clockTrig(${l[0].loop},${l.length>1?l[1].loop:0})`},clfreq:{setup:(o,l)=>"",loop:(o,l)=>`this.setClockFreq(${l[0].loop})`},clbpm:{setup:(o,l)=>"",loop:(o,l)=>`this.setClockFreq(60/${l[0].loop})`},barfreq:{setup:(o,l)=>"",loop:(o,l)=>`this.setBarFrequency(${l[0].loop})`},onzx:{setup:(o,l)=>`${o} = new Maximilian.maxiTrigger();`,loop:(o,l)=>`${o}.onZX(${l[0].loop})`},onchange:{setup:(o,l)=>`${o} = new Maximilian.maxiTrigger();`,loop:(o,l)=>`${o}.onChanged(${l[0].loop},${l[1].loop})`},count:{setup:(o,l)=>`${o} = new Maximilian.maxiCounter();`,loop:(o,l)=>`${o}.count(${l[0].loop},${l[1].loop})`},idx:{setup:(o,l)=>`${o} = new Maximilian.maxiIndex();`,loop:(o,l)=>`${o}.pull(${l[0].loop},${l[1].loop},${l[2].loop})`},svf:{setup:(o,l)=>`${o} = new Maximilian.maxiSVF(); ${o}_p1 = new Maximilian.maxiTrigger(); ${o}_p2 = new Maximilian.maxiTrigger();`,loop:(o,l)=>`(()=>{${o}_cutoff = ${l[1].loop}; if (${o}_p1.onChanged(${o}_cutoff, 1e-5)) {${o}.setCutoff(${o}_cutoff)};\n                            ${o}_res = ${l[2].loop}; if (${o}_p2.onChanged(${o}_res, 1e-5)) {${o}.setResonance(${o}_res)};\n                        return ${o}.play(${l[0].loop},${l[3].loop},${l[4].loop},${l[5].loop},${l[6].loop})})()`},bitclock:{setup:(o,l)=>"",loop:(o,l)=>"this.bitclock"},pvshift:{setup:(o,l)=>`${o} = new pvshift();`,loop:(o,l)=>`${o}.play(${l[0].loop},${l[1].loop})`},rsq:{setup:(o,l)=>`${o} = new Maximilian.maxiRatioSeq();`,loop:(o,l)=>2==l.length?`${o}.playTrig(${l[0].loop},${l[1].loop})`:`${o}.playValues(${l[0].loop},${l[1].loop},${l[2].loop})`}};class a{static getNextID(){return p=p>9999?0:++p}static emptyCode(){return{setup:"",loop:"",paramMarkers:[]}}static traverseTree(o,l,e,p,t){let s={"@lang":(o,l)=>(l.map(l=>{let i=a.traverseTree(l,a.emptyCode(),e,p,t);o.setup+=i.setup,o.loop+=i.loop}),o),"@sigOut":(o,l)=>((o=a.traverseTree(l,o,e,p,t)).loop=`q.sigOut = ${o.loop};`,o),"@spawn":(o,l)=>((o=a.traverseTree(l,o,e,p,t)).loop+=";",o),"@sigp":(o,l)=>{let s=[{s:l.paramBegin,e:l.paramEnd,l:e}];o.paramMarkers=o.paramMarkers.concat(s);let $=l["@func"].value,n=i[$],r="q.b"+t+"u"+a.getNextID(),u=[];for(let o=0;o<l["@params"].length;o++){let i=a.emptyCode();i=a.traverseTree(l["@params"][o],i,e+1,p,t),u[o]=i}let m="";for(let l in u)m+=u[l].setup,o.paramMarkers=o.paramMarkers.concat(u[l].paramMarkers);return o.setup+=`${m} ${n.setup(r,u)};`,o.loop+=`${n.loop(r,u)}`,o},"@setvar":(o,l)=>{let i=l["@varname"].value,s=p[i];null==s&&(s=Object.keys(p).length,p[i]=s);let $=a.traverseTree(l["@varvalue"],a.emptyCode(),e+1,p,t);return o.setup+=$.setup,o.loop=`(mem[${s}] = ${$.loop})`,o},"@getvar":(o,l)=>{let e=p[l.value];return null==e&&(e=Object.keys(p).length,p[l.value]=e),o.loop+=`mem[${e}]`,o},"@string":(o,l)=>(("string"==typeof l.value||l.value instanceof String)&&(o.loop+=`'${l.value}'`),o),"@num":(o,l)=>(l.value&&(o.loop+=`${l.value}`),o),"@list":(o,l)=>{let i="q.b"+t+"l"+a.getNextID();o.setup+=`${i} = new Maximilian.VectorDouble();`,o.setup+=`${i}.resize(${l.length},0);`,o.loop+="(()=>{";let s="";for(let $=0;$<l.length;$++){let n=a.traverseTree(l[$],a.emptyCode(),e,p,t);"@num"==Object.keys(l[$])[0]?o.setup+=`${i}.set(${$}, ${n.loop});`:(s+=n.setup,o.loop+=`${i}.set(${$}, ${n.loop});`)}return o.loop+=`return ${i}})()`,o.setup+=s,o}};return Array.isArray(o)?o.map(o=>{Object.keys(o).map(e=>{l=s[e](l,o[e])})}):Object.keys(o).map(e=>{l=s[e](l,o[e])}),l}static treeToCode(o,l=0){t={};let e=a.traverseTree(o,a.emptyCode(),0,t,l);return e.setup=`() => {let q=this.newq(); ${e.setup}; return q;}`,e.loop=`(q, inputs, mem) => {${e.loop} return q.sigOut;}`,e}}var s=a;onmessage=o=>{if(void 0!==o.data)try{let l=s.treeToCode(o.data.liveCodeAbstractSyntaxTree[0]);l.paramMarkers=JSON.stringify(l.paramMarkers),postMessage(l)}catch(o){console.log("DEBUG:il.worker:onmessage:catch"),console.log(o)}}}]);